# Indexing server image (minimal copy)
FROM python:3.11-slim

WORKDIR /app

# Copy only the code needed to run the server
COPY common/ /app/common/
COPY indexing_server/ /app/indexing_server/
# Config is mounted at runtime, but copying is harmless and small
COPY config/ /app/config/

ENV PYTHONDONTWRITEBYTECODE=1
ENV PYTHONUNBUFFERED=1
ENV PYTHONPATH=/app

# Default server port
EXPOSE 7000

CMD ["python", "-m", "indexing_server.server"]